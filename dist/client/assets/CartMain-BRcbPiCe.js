import{j as e}from"./jsx-runtime-D0bAEALd.js";import{J as l,n as g}from"./index-Digrjsd9.js";import{u as b}from"./Aside-5mz_CcTc.js";import{u as j}from"./variants-Dh1CjIVe.js";import{L as N}from"./chunk-TMI4QPZX-DO0jBZYa.js";import{P as v}from"./ProductPrice-DdIG_GCw.js";import{I as w}from"./Image-BeczY5HY.js";import{M as C}from"./Money-t5T8g3vm.js";function I({layout:t,line:a}){var d;const{id:s,merchandise:n}=a,{product:r,title:i,image:u,selectedOptions:o}=n,m=j(r.handle,o),{close:x}=b();return e.jsxs("li",{className:"cart-line flex gap-4 py-4 border-b border-gray-100 last:border-0 relative group",children:[u&&e.jsx("div",{className:"shrink-0 aspect-square w-[90px] h-[90px] rounded-2xl overflow-hidden bg-gray-50 shadow-sm border border-gray-100",children:e.jsx(w,{alt:i,aspectRatio:"1/1",data:u,height:100,loading:"lazy",width:100,className:"w-full h-full object-cover mix-blend-multiply"})}),e.jsxs("div",{className:"flex-1 flex flex-col justify-between py-1",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsx(N,{prefetch:"intent",to:m,onClick:()=>{t==="aside"&&x()},className:"font-bold text-base text-gray-900 leading-tight hover:underline decoration-1 underline-offset-2",children:r.title}),e.jsx(v,{price:(d=a==null?void 0:a.cost)==null?void 0:d.totalAmount,className:"font-semibold text-sm text-gray-900"})]}),o.length>0&&e.jsx("ul",{className:"mt-1 space-y-1",children:o.map(c=>e.jsxs("li",{className:"text-xs text-gray-500 font-medium tracking-wide uppercase",children:[c.name,": ",c.value]},c.name))})]}),e.jsx("div",{className:"flex items-center justify-between mt-3",children:e.jsx(k,{line:a})})]})]},s)}function k({line:t}){if(!t||typeof(t==null?void 0:t.quantity)>"u")return null;const{id:a,quantity:s,isOptimistic:n}=t,r=Number(Math.max(0,s-1).toFixed(0)),i=Number((s+1).toFixed(0));return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center border border-gray-200 rounded-full bg-white shadow-sm overflow-hidden h-8",children:[e.jsx(f,{lines:[{id:a,quantity:r}],children:e.jsx("button",{"aria-label":"Decrease quantity",disabled:s<=1||!!n,name:"decrease-quantity",value:r,className:"w-8 h-full flex items-center justify-center hover:bg-gray-50 transition-colors disabled:opacity-50 text-gray-600",children:e.jsx("span",{children:"−"})})}),e.jsx("span",{className:"w-8 text-center text-sm font-semibold text-gray-900 tabular-nums select-none",children:s}),e.jsx(f,{lines:[{id:a,quantity:i}],children:e.jsx("button",{"aria-label":"Increase quantity",name:"increase-quantity",value:i,disabled:!!n,className:"w-8 h-full flex items-center justify-center hover:bg-gray-50 transition-colors disabled:opacity-50 text-gray-600",children:e.jsx("span",{children:"+"})})})]}),e.jsx(q,{lineIds:[a],disabled:!!n})]})}function q({lineIds:t,disabled:a}){return e.jsx(l,{fetcherKey:y(t),route:"/cart",action:l.ACTIONS.LinesRemove,inputs:{lineIds:t},children:e.jsx("button",{disabled:a,type:"submit",className:"text-xs text-gray-400 underline hover:text-red-500 transition-colors",children:"Remove"})})}function f({children:t,lines:a}){const s=a.map(n=>n.id);return e.jsx(l,{fetcherKey:y(s),route:"/cart",action:l.ACTIONS.LinesUpdate,inputs:{lines:a},children:t})}function y(t){return[l.ACTIONS.LinesUpdate,...t].join("-")}function A({cart:t,layout:a}){var n,r,i;const s=a==="page"?"cart-summary-page":"cart-summary-aside";return e.jsxs("div",{"aria-labelledby":"cart-summary",className:`${s} border-t border-gray-100 bg-white px-6 py-6 pb-safe safe-area-bottom`,children:[e.jsx("h4",{className:"sr-only",children:"Totals"}),e.jsxs("dl",{className:"cart-subtotal mb-4 flex items-center justify-between text-base",children:[e.jsx("dt",{className:"text-gray-500 font-medium",children:"Subtotal"}),e.jsx("dd",{className:"font-bold text-gray-900 tracking-tight",children:(r=(n=t==null?void 0:t.cost)==null?void 0:n.subtotalAmount)!=null&&r.amount?e.jsx(C,{data:(i=t==null?void 0:t.cost)==null?void 0:i.subtotalAmount}):"-"})]}),e.jsx(L,{discountCodes:t==null?void 0:t.discountCodes}),e.jsx(D,{checkoutUrl:t==null?void 0:t.checkoutUrl})]})}function D({checkoutUrl:t}){return t?e.jsx("div",{className:"mt-6",children:e.jsx("a",{href:t,target:"_self",className:"flex items-center justify-center w-full rounded-full bg-[#1a1a1a] py-4 px-6 text-center !text-white !font-bold text-lg hover:bg-black hover:scale-[1.02] transition-all shadow-xl",children:"Continue to Checkout →"})}):null}function L({discountCodes:t}){var s;const a=((s=t==null?void 0:t.filter(n=>n.applicable))==null?void 0:s.map(({code:n})=>n))||[];return e.jsxs("div",{className:"mb-4",children:[e.jsx("dl",{hidden:!a.length,className:"mb-2",children:e.jsxs("div",{className:"flex items-center justify-between bg-green-50 px-3 py-2 rounded-lg border border-green-100",children:[e.jsx("dt",{className:"text-green-800 text-sm font-medium",children:"Discount"}),e.jsx(p,{children:e.jsxs("div",{className:"cart-discount flex items-center gap-2",children:[e.jsx("code",{className:"text-xs font-mono text-green-700 bg-white px-1.5 py-0.5 rounded border border-green-200",children:a==null?void 0:a.join(", ")}),e.jsx("button",{"aria-label":"Remove discount",className:"text-green-600 hover:text-green-800",children:e.jsx("span",{"aria-hidden":"true",children:"×"})})]})})]})}),e.jsx(p,{discountCodes:a,children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",name:"discountCode",placeholder:"Discount code",className:"flex-1 rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 text-sm focus:border-black focus:ring-1 focus:ring-black outline-none transition-all"}),e.jsx("button",{type:"submit",className:"rounded-lg bg-gray-900 text-white px-4 text-sm font-medium hover:bg-gray-800 transition-colors",children:"Apply"})]})})]})}function p({discountCodes:t,children:a}){return e.jsx(l,{route:"/cart",action:l.ACTIONS.DiscountCodesUpdate,inputs:{discountCodes:t||[]},children:a})}function z({layout:t,cart:a}){var o,m,x,d,c;const s=g(a),n=!!((m=(o=s==null?void 0:s.lines)==null?void 0:o.nodes)!=null&&m.length),i=`cart-main ${s&&!!((d=(x=s==null?void 0:s.discountCodes)==null?void 0:x.filter(h=>h.applicable))!=null&&d.length)?"with-discount":""}`,u=s!=null&&s.totalQuantity?s.totalQuantity>0:!1;return e.jsxs("div",{className:`${i} h-full flex flex-col bg-white`,children:[e.jsx(U,{hidden:n,layout:t}),e.jsxs("div",{className:"cart-details flex flex-col h-full overflow-hidden",children:[e.jsx("div",{"aria-labelledby":"cart-lines",className:"flex-1 overflow-y-auto custom-scrollbar px-6 py-4",children:e.jsx("ul",{className:"space-y-6",children:(((c=s==null?void 0:s.lines)==null?void 0:c.nodes)??[]).map(h=>e.jsx(I,{line:h,layout:t},h.id))})}),u&&e.jsx(A,{cart:s,layout:t})]})]})}function U({hidden:t=!1}){const{close:a}=b();return e.jsx("div",{hidden:t,className:"px-6 py-12 text-center",children:e.jsxs("div",{className:"max-w-md mx-auto space-y-4",children:[e.jsx("h3",{className:"text-2xl font-bold text-[#1D1E20]",children:"Tu ritual perfecto te espera"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Energía, Enfoque y Descanso. Elige tu fórmula y empieza a optimizar cada hora de tu día."})]})})}export{z as C};
